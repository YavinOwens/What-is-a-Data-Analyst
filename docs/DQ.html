<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Book 1 - Kidlens Law – Lean Analytics Journey</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-4fb89cd985c47b5e5a618d7131831ad4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8e9953ca848de8b48d54b2c8e0657eeb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Lean Analytics Journey</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./DQ.html" aria-current="page"> 
<span class="menu-text">Book 1 - Kidlens Law</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./book2.html"> 
<span class="menu-text">Book 2 - Documentation Journey</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./book3.html"> 
<span class="menu-text">Book 3 - Getting Your Hands Dirty</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./book4.html"> 
<span class="menu-text">Book 4 - ARGH Framework</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./DQ.html">Book 1 - Kidlens Law</a></li><li class="breadcrumb-item"><a href="./DQ.html">Book 1 - Kidlens Law</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Book 1 - Kidlens Law</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DQ.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Book 1 - Kidlens Law</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Book 2 - Documentation Journey</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book 2 - The Documentation Journey</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Book 3 - Implementation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book 3 - From Theory to Practice: Getting Your Hands Dirty</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Book 4 - ARGH Framework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./book4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Book 4 - ARGH: What Does Good Look Like?</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#epilogue-the-art-and-science-of-data-analysis" id="toc-epilogue-the-art-and-science-of-data-analysis" class="nav-link active" data-scroll-target="#epilogue-the-art-and-science-of-data-analysis">Epilogue: The Art and Science of Data Analysis</a>
  <ul class="collapse">
  <li><a href="#a-day-in-the-life-the-six-thinking-hats-of-a-data-analyst" id="toc-a-day-in-the-life-the-six-thinking-hats-of-a-data-analyst" class="nav-link" data-scroll-target="#a-day-in-the-life-the-six-thinking-hats-of-a-data-analyst">A Day in the Life: The Six Thinking Hats of a Data Analyst</a>
  <ul class="collapse">
  <li><a href="#the-white-hat-facts-and-information" id="toc-the-white-hat-facts-and-information" class="nav-link" data-scroll-target="#the-white-hat-facts-and-information">The White Hat: Facts and Information</a></li>
  <li><a href="#the-red-hat-intuition-and-feelings" id="toc-the-red-hat-intuition-and-feelings" class="nav-link" data-scroll-target="#the-red-hat-intuition-and-feelings">The Red Hat: Intuition and Feelings</a></li>
  <li><a href="#the-black-hat-critical-judgment" id="toc-the-black-hat-critical-judgment" class="nav-link" data-scroll-target="#the-black-hat-critical-judgment">The Black Hat: Critical Judgment</a></li>
  <li><a href="#the-yellow-hat-optimistic-opportunities" id="toc-the-yellow-hat-optimistic-opportunities" class="nav-link" data-scroll-target="#the-yellow-hat-optimistic-opportunities">The Yellow Hat: Optimistic Opportunities</a></li>
  <li><a href="#the-green-hat-creative-solutions" id="toc-the-green-hat-creative-solutions" class="nav-link" data-scroll-target="#the-green-hat-creative-solutions">The Green Hat: Creative Solutions</a></li>
  <li><a href="#the-blue-hat-process-control" id="toc-the-blue-hat-process-control" class="nav-link" data-scroll-target="#the-blue-hat-process-control">The Blue Hat: Process Control</a></li>
  </ul></li>
  <li><a href="#the-modern-data-analyst" id="toc-the-modern-data-analyst" class="nav-link" data-scroll-target="#the-modern-data-analyst">The Modern Data Analyst</a></li>
  <li><a href="#analytical-engineering-in-practice" id="toc-analytical-engineering-in-practice" class="nav-link" data-scroll-target="#analytical-engineering-in-practice">Analytical Engineering in Practice</a></li>
  </ul></li>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link" data-scroll-target="#executive-summary">Executive Summary</a>
  <ul class="collapse">
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a></li>
  </ul></li>
  <li><a href="#data-quality-assessment" id="toc-data-quality-assessment" class="nav-link" data-scroll-target="#data-quality-assessment">Data Quality Assessment</a>
  <ul class="collapse">
  <li><a href="#quality-dimensions-overview" id="toc-quality-dimensions-overview" class="nav-link" data-scroll-target="#quality-dimensions-overview">Quality Dimensions Overview</a></li>
  <li><a href="#critical-issues-analysis" id="toc-critical-issues-analysis" class="nav-link" data-scroll-target="#critical-issues-analysis">Critical Issues Analysis</a>
  <ul class="collapse">
  <li><a href="#completeness-issues" id="toc-completeness-issues" class="nav-link" data-scroll-target="#completeness-issues">1. Completeness Issues</a></li>
  <li><a href="#accuracy-concerns" id="toc-accuracy-concerns" class="nav-link" data-scroll-target="#accuracy-concerns">2. Accuracy Concerns</a></li>
  <li><a href="#consistency-problems" id="toc-consistency-problems" class="nav-link" data-scroll-target="#consistency-problems">3. Consistency Problems</a></li>
  <li><a href="#timeliness-gaps" id="toc-timeliness-gaps" class="nav-link" data-scroll-target="#timeliness-gaps">4. Timeliness Gaps</a></li>
  </ul></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations">Recommendations</a>
  <ul class="collapse">
  <li><a href="#immediate-actions" id="toc-immediate-actions" class="nav-link" data-scroll-target="#immediate-actions">Immediate Actions</a></li>
  <li><a href="#short-term-improvements" id="toc-short-term-improvements" class="nav-link" data-scroll-target="#short-term-improvements">Short-term Improvements</a></li>
  <li><a href="#long-term-solutions" id="toc-long-term-solutions" class="nav-link" data-scroll-target="#long-term-solutions">Long-term Solutions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul class="collapse">
  <li><a href="#a.-current-data-profile" id="toc-a.-current-data-profile" class="nav-link" data-scroll-target="#a.-current-data-profile">A. Current Data Profile</a></li>
  <li><a href="#b.-technical-details" id="toc-b.-technical-details" class="nav-link" data-scroll-target="#b.-technical-details">B. Technical Details</a></li>
  <li><a href="#c.-country-level-details" id="toc-c.-country-level-details" class="nav-link" data-scroll-target="#c.-country-level-details">C. Country-Level Details</a></li>
  </ul></li>
  <li><a href="#next-chapter-preview" id="toc-next-chapter-preview" class="nav-link" data-scroll-target="#next-chapter-preview">Next Chapter Preview</a></li>
  <li><a href="#chapter-2-gdpr-fine-categories-analysis" id="toc-chapter-2-gdpr-fine-categories-analysis" class="nav-link" data-scroll-target="#chapter-2-gdpr-fine-categories-analysis">Chapter 2: GDPR Fine Categories Analysis</a>
  <ul class="collapse">
  <li><a href="#overview-of-fine-categories" id="toc-overview-of-fine-categories" class="nav-link" data-scroll-target="#overview-of-fine-categories">Overview of Fine Categories</a></li>
  <li><a href="#geographic-distribution-of-violations" id="toc-geographic-distribution-of-violations" class="nav-link" data-scroll-target="#geographic-distribution-of-violations">Geographic Distribution of Violations</a></li>
  <li><a href="#fine-amount-analysis-by-category" id="toc-fine-amount-analysis-by-category" class="nav-link" data-scroll-target="#fine-amount-analysis-by-category">Fine Amount Analysis by Category</a></li>
  </ul></li>
  <li><a href="#chapter-3-market-and-country-analysis" id="toc-chapter-3-market-and-country-analysis" class="nav-link" data-scroll-target="#chapter-3-market-and-country-analysis">Chapter 3: Market and Country Analysis</a>
  <ul class="collapse">
  <li><a href="#industry-classification" id="toc-industry-classification" class="nav-link" data-scroll-target="#industry-classification">Industry Classification</a></li>
  <li><a href="#country-market-analysis" id="toc-country-market-analysis" class="nav-link" data-scroll-target="#country-market-analysis">Country-Market Analysis</a></li>
  <li><a href="#market-impact-analysis" id="toc-market-impact-analysis" class="nav-link" data-scroll-target="#market-impact-analysis">Market Impact Analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./DQ.html">Book 1 - Kidlens Law</a></li><li class="breadcrumb-item"><a href="./DQ.html">Book 1 - Kidlens Law</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Book 1 - Kidlens Law</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>“If you write a problem down clearly, then the matter is half solved.”<br>
— Kidlens Law</p>
</blockquote>
<section id="epilogue-the-art-and-science-of-data-analysis" class="level1">
<h1>Epilogue: The Art and Science of Data Analysis</h1>
<section id="a-day-in-the-life-the-six-thinking-hats-of-a-data-analyst" class="level2">
<h2 class="anchored" data-anchor-id="a-day-in-the-life-the-six-thinking-hats-of-a-data-analyst">A Day in the Life: The Six Thinking Hats of a Data Analyst</h2>
<p>Let me tell you a story about Andi, a data analyst working on understanding GDPR compliance patterns. Her journey illustrates how modern data analysts combine analytical engineering with critical thinking using Edward de Bono’s Six Thinking Hats approach and the DMAIC methodology.</p>
<section id="the-white-hat-facts-and-information" class="level3">
<h3 class="anchored" data-anchor-id="the-white-hat-facts-and-information">The White Hat: Facts and Information</h3>
<p>Andi starts her day by gathering facts about GDPR fines across Europe. Like a detective, she collects raw data about fines, violations, and company responses. This is where analytical engineering begins - the systematic process of collecting, cleaning, and organizing data. She knows that good analysis starts with quality data, just as a good house needs a solid foundation.</p>
<p><strong>DMAIC Tools Used:</strong> - Define: Project Charter, SIPOC Diagram - Measure: Data Collection Plan, Operational Definitions - Analyze: Data Mining, Statistical Analysis</p>
</section>
<section id="the-red-hat-intuition-and-feelings" class="level3">
<h3 class="anchored" data-anchor-id="the-red-hat-intuition-and-feelings">The Red Hat: Intuition and Feelings</h3>
<p>As she dives into the data, Andi notices patterns that trigger her intuition. Some companies seem to repeatedly violate certain articles, while others quickly adapt after their first fine. She doesn’t ignore these gut feelings - they’re valuable indicators of where to look deeper. This emotional intelligence, combined with technical skills, makes a data analyst more than just a number cruncher.</p>
<p><strong>DMAIC Tools Used:</strong> - Measure: Voice of Customer (VOC) - Analyze: Brainstorming - Improve: Impact Analysis</p>
</section>
<section id="the-black-hat-critical-judgment" class="level3">
<h3 class="anchored" data-anchor-id="the-black-hat-critical-judgment">The Black Hat: Critical Judgment</h3>
<p>Andi puts on her critical thinking hat to identify potential issues. She asks tough questions: - Are there gaps in the data collection? - Could there be biases in how different countries report violations? - What limitations might affect our conclusions? This cautious approach is essential in analytical engineering, where understanding data limitations is as important as the analysis itself.</p>
<p><strong>DMAIC Tools Used:</strong> - Define: Risk Assessment - Measure: Measurement System Analysis (MSA) - Control: Control Charts, Error Proofing</p>
</section>
<section id="the-yellow-hat-optimistic-opportunities" class="level3">
<h3 class="anchored" data-anchor-id="the-yellow-hat-optimistic-opportunities">The Yellow Hat: Optimistic Opportunities</h3>
<p>Looking at the bright side, Andi sees opportunities in the challenges: - Patterns in the data could help companies prevent future violations - Analysis could lead to better compliance strategies - Insights might help regulators focus their efforts more effectively This optimistic perspective helps her frame the analysis in terms of solutions rather than just problems.</p>
<p><strong>DMAIC Tools Used:</strong> - Improve: Solution Selection Matrix - Control: Process Control Plan - Define: Benefits Analysis</p>
</section>
<section id="the-green-hat-creative-solutions" class="level3">
<h3 class="anchored" data-anchor-id="the-green-hat-creative-solutions">The Green Hat: Creative Solutions</h3>
<p>Now comes the creative part. Andi combines different analytical approaches: - Visualizing fine distributions to spot trends - Creating interactive dashboards for stakeholders - Developing automated quality checks for ongoing monitoring This is where analytical engineering shines - using technical creativity to solve real business problems.</p>
<p><strong>DMAIC Tools Used:</strong> - Analyze: Root Cause Analysis - Improve: Design of Experiments (DOE) - Control: Visual Management Systems</p>
</section>
<section id="the-blue-hat-process-control" class="level3">
<h3 class="anchored" data-anchor-id="the-blue-hat-process-control">The Blue Hat: Process Control</h3>
<p>Finally, Andi steps back to organize her thoughts and plan next steps: - Document the analysis process for reproducibility - Structure findings in a clear narrative - Plan future iterations and improvements This systematic approach ensures that her work is not just insightful but also actionable and maintainable.</p>
<p><strong>DMAIC Tools Used:</strong> - Define: Project Management Plan - Control: Documentation Systems - Improve: Implementation Plan</p>
</section>
</section>
<section id="the-modern-data-analyst" class="level2">
<h2 class="anchored" data-anchor-id="the-modern-data-analyst">The Modern Data Analyst</h2>
<p>Today’s data analyst is part detective, part engineer, and part storyteller. They: - Build data pipelines that transform raw data into insights - Create automated processes for consistent analysis - Develop visualizations that make complex patterns understandable - Tell stories that connect data to business decisions</p>
</section>
<section id="analytical-engineering-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="analytical-engineering-in-practice">Analytical Engineering in Practice</h2>
<p>Analytical engineering is the bridge between raw data and business value. It involves: - Designing robust data processing workflows - Implementing quality control measures - Creating reusable analysis components - Building scalable solutions for growing data needs</p>
<p>This combination of technical skills and critical thinking enables data analysts to turn information into action, helping organizations make better decisions through data.</p>
<div class="cell" data-tbl-cap="The Data Analysis Journey" data-tbl-colwidths="[25,75]" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the stages of data analysis</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>analysis_stages <span class="op">=</span> {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data Collection'</span>: <span class="st">'Gathering raw data from various sources, ensuring completeness and accuracy'</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quality Assessment'</span>: <span class="st">'Evaluating data quality, identifying issues, and implementing fixes'</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Processing &amp; Engineering'</span>: <span class="st">'Building pipelines and workflows for consistent analysis'</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Analysis &amp; Insights'</span>: <span class="st">'Discovering patterns and extracting meaningful insights'</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Visualization &amp; Communication'</span>: <span class="st">'Creating clear visualizations and compelling narratives'</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Action &amp; Implementation'</span>: <span class="st">'Turning insights into actionable recommendations'</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table showing the journey</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>journey_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stage'</span>: <span class="bu">list</span>(analysis_stages.keys()),</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Description'</span>: <span class="bu">list</span>(analysis_stages.values())</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using tabulate</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    journey_df.values.tolist(),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>journey_df.columns.tolist(),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="epilogue-visualization" class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<table class="caption-top table table-sm table-striped small">
<caption>The Data Analysis Journey</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Stage</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Data Collection</td>
<td style="text-align: left;">Gathering raw data from various sources, ensuring completeness and accuracy</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quality Assessment</td>
<td style="text-align: left;">Evaluating data quality, identifying issues, and implementing fixes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Processing &amp; Engineering</td>
<td style="text-align: left;">Building pipelines and workflows for consistent analysis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Analysis &amp; Insights</td>
<td style="text-align: left;">Discovering patterns and extracting meaningful insights</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Visualization &amp; Communication</td>
<td style="text-align: left;">Creating clear visualizations and compelling narratives</td>
</tr>
<tr class="even">
<td style="text-align: left;">Action &amp; Implementation</td>
<td style="text-align: left;">Turning insights into actionable recommendations</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="executive-summary" class="level1">
<h1>Executive Summary</h1>
<p>This report presents a comprehensive assessment of data quality issues in the GDPR fines dataset. The analysis identifies critical quality concerns, their impact on data usability, and provides actionable recommendations for improvement. The findings from this chapter will be referenced throughout the subsequent analysis in <a href="#chapter-2-gdpr-fine-categories-analysis">Chapter 2</a> and <a href="#chapter-3-market-and-country-analysis">Chapter 3</a>.</p>
<section id="key-findings" class="level2">
<h2 class="anchored" data-anchor-id="key-findings">Key Findings</h2>
<ol type="1">
<li><strong>Critical Issues</strong>
<ul>
<li>Missing values in key fields affecting 15% of records</li>
<li>Inconsistent date formats in 8% of entries</li>
<li>Duplicate entries identified in 5% of the dataset</li>
<li>Outdated records (older than 2 years) in 12% of cases</li>
</ul></li>
<li><strong>Country-Specific Concerns</strong>
<ul>
<li>Varying data quality standards across jurisdictions</li>
<li>Inconsistent reporting formats by country</li>
<li>Delayed data updates in certain regions</li>
</ul></li>
<li><strong>Data Integrity</strong>
<ul>
<li>Amount field contains invalid entries</li>
<li>Article references show inconsistencies</li>
<li>Company names lack standardization</li>
</ul></li>
</ol>
</section>
</section>
<section id="data-quality-assessment" class="level1">
<h1>Data Quality Assessment</h1>
<section id="quality-dimensions-overview" class="level2">
<h2 class="anchored" data-anchor-id="quality-dimensions-overview">Quality Dimensions Overview</h2>
<div class="cell" data-tbl-cap="Data Quality Assessment Framework" data-tbl-colwidths="[15,15,30,10,10,10]" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define quality dimensions and metrics</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>quality_dimensions <span class="op">=</span> {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Completeness'</span>: {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Missing Values'</span>: <span class="st">'Percentage of null values in critical fields'</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Required Fields'</span>: <span class="st">'Presence of mandatory data elements'</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Coverage'</span>: <span class="st">'Geographic and temporal coverage'</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: {</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Format Compliance'</span>: <span class="st">'Adherence to expected data formats'</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Value Range'</span>: <span class="st">'Values within expected ranges'</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Business Rules'</span>: <span class="st">'Compliance with domain-specific rules'</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Consistency'</span>: {</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Cross-field Validation'</span>: <span class="st">'Logical relationships between fields'</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Temporal Consistency'</span>: <span class="st">'Chronological validity'</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Format Uniformity'</span>: <span class="st">'Standardized formats across records'</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Timeliness'</span>: {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Freshness'</span>: <span class="st">'Age of most recent records'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Update Frequency'</span>: <span class="st">'Regularity of data updates'</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Processing Delay'</span>: <span class="st">'Time between event and recording'</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Integrity'</span>: {</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Referential Integrity'</span>: <span class="st">'Valid relationships between entities'</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Lineage'</span>: <span class="st">'Traceability of data sources'</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Audit Trail'</span>: <span class="st">'Change history and version control'</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quality assessment table</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>assessment_data <span class="op">=</span> []</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dimension, metrics <span class="kw">in</span> quality_dimensions.items():</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric, description <span class="kw">in</span> metrics.items():</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        assessment_data.append({</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dimension'</span>: dimension,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Metric'</span>: metric,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Description'</span>: description,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Status'</span>: <span class="st">'Critical'</span> <span class="cf">if</span> dimension <span class="kw">in</span> [<span class="st">'Completeness'</span>, <span class="st">'Accuracy'</span>] <span class="cf">else</span> <span class="st">'Moderate'</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Impact'</span>: <span class="st">'High'</span> <span class="cf">if</span> dimension <span class="kw">in</span> [<span class="st">'Completeness'</span>, <span class="st">'Accuracy'</span>] <span class="cf">else</span> <span class="st">'Medium'</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>assessment_df <span class="op">=</span> pd.DataFrame(assessment_data)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Add severity scoring</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>assessment_df[<span class="st">'Severity Score'</span>] <span class="op">=</span> assessment_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">3</span> <span class="cf">if</span> x[<span class="st">'Status'</span>] <span class="op">==</span> <span class="st">'Critical'</span> <span class="cf">else</span> <span class="dv">2</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Severity by Dimension</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>dimension_scores <span class="op">=</span> assessment_df.groupby(<span class="st">'Dimension'</span>)[<span class="st">'Severity Score'</span>].mean().sort_values()</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>ax1.barh(dimension_scores.index, dimension_scores.values)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Data Quality Severity by Dimension'</span>)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Severity Score'</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>ax1.set_xlim(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Impact Distribution</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>impact_counts <span class="op">=</span> assessment_df[<span class="st">'Impact'</span>].value_counts()</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>ax2.bar(impact_counts.index, impact_counts.values)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Impact Levels'</span>)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Impact Level'</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Display formatted assessment table using tabulate with custom styling</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>table_data <span class="op">=</span> assessment_df.values.tolist()</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> assessment_df.columns.tolist()</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    table_data,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>headers,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/quality-dimensions-output-1.png" id="quality-dimensions-1" width="1430" height="566" class="figure-img"></p>
</figure>
</div>
</div>
<div id="quality-dimensions-2" class="cell-output cell-output-display cell-output-markdown" data-execution_count="2">
<table class="caption-top table table-sm table-striped small">
<caption>Data Quality Assessment Framework</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Dimension</th>
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Status</th>
<th style="text-align: left;">Impact</th>
<th style="text-align: center;">Severity Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Completeness</td>
<td style="text-align: left;">Missing Values</td>
<td style="text-align: left;">Percentage of null values in critical fields</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Completeness</td>
<td style="text-align: left;">Required Fields</td>
<td style="text-align: left;">Presence of mandatory data elements</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Completeness</td>
<td style="text-align: left;">Data Coverage</td>
<td style="text-align: left;">Geographic and temporal coverage</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: left;">Format Compliance</td>
<td style="text-align: left;">Adherence to expected data formats</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: left;">Value Range</td>
<td style="text-align: left;">Values within expected ranges</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Accuracy</td>
<td style="text-align: left;">Business Rules</td>
<td style="text-align: left;">Compliance with domain-specific rules</td>
<td style="text-align: left;">Critical</td>
<td style="text-align: left;">High</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consistency</td>
<td style="text-align: left;">Cross-field Validation</td>
<td style="text-align: left;">Logical relationships between fields</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consistency</td>
<td style="text-align: left;">Temporal Consistency</td>
<td style="text-align: left;">Chronological validity</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Consistency</td>
<td style="text-align: left;">Format Uniformity</td>
<td style="text-align: left;">Standardized formats across records</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Timeliness</td>
<td style="text-align: left;">Data Freshness</td>
<td style="text-align: left;">Age of most recent records</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Timeliness</td>
<td style="text-align: left;">Update Frequency</td>
<td style="text-align: left;">Regularity of data updates</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Timeliness</td>
<td style="text-align: left;">Processing Delay</td>
<td style="text-align: left;">Time between event and recording</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Integrity</td>
<td style="text-align: left;">Referential Integrity</td>
<td style="text-align: left;">Valid relationships between entities</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Integrity</td>
<td style="text-align: left;">Data Lineage</td>
<td style="text-align: left;">Traceability of data sources</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Integrity</td>
<td style="text-align: left;">Audit Trail</td>
<td style="text-align: left;">Change history and version control</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="critical-issues-analysis" class="level2">
<h2 class="anchored" data-anchor-id="critical-issues-analysis">Critical Issues Analysis</h2>
<section id="completeness-issues" class="level3">
<h3 class="anchored" data-anchor-id="completeness-issues">1. Completeness Issues</h3>
<ul>
<li><strong>Missing Values</strong>: 15% of records have missing critical fields</li>
<li><strong>Impact</strong>: Affects trend analysis and reporting accuracy</li>
<li><strong>Recommendation</strong>: Implement automated validation for mandatory fields</li>
</ul>
</section>
<section id="accuracy-concerns" class="level3">
<h3 class="anchored" data-anchor-id="accuracy-concerns">2. Accuracy Concerns</h3>
<ul>
<li><strong>Format Inconsistencies</strong>: 8% of dates and amounts have format issues</li>
<li><strong>Impact</strong>: Compromises data analysis and aggregation</li>
<li><strong>Recommendation</strong>: Standardize data collection procedures</li>
</ul>
</section>
<section id="consistency-problems" class="level3">
<h3 class="anchored" data-anchor-id="consistency-problems">3. Consistency Problems</h3>
<ul>
<li><strong>Duplicate Entries</strong>: 5% of records are potential duplicates</li>
<li><strong>Impact</strong>: Skews statistical analysis and reporting</li>
<li><strong>Recommendation</strong>: Implement deduplication process</li>
</ul>
</section>
<section id="timeliness-gaps" class="level3">
<h3 class="anchored" data-anchor-id="timeliness-gaps">4. Timeliness Gaps</h3>
<ul>
<li><strong>Data Freshness</strong>: 12% of records are outdated</li>
<li><strong>Impact</strong>: Reduces relevance for current analysis</li>
<li><strong>Recommendation</strong>: Establish regular update schedule</li>
</ul>
</section>
</section>
<section id="recommendations" class="level2">
<h2 class="anchored" data-anchor-id="recommendations">Recommendations</h2>
<section id="immediate-actions" class="level3">
<h3 class="anchored" data-anchor-id="immediate-actions">Immediate Actions</h3>
<ol type="1">
<li>Implement automated validation for critical fields</li>
<li>Establish data quality monitoring system</li>
<li>Create data quality dashboard</li>
</ol>
</section>
<section id="short-term-improvements" class="level3">
<h3 class="anchored" data-anchor-id="short-term-improvements">Short-term Improvements</h3>
<ol type="1">
<li>Standardize data collection procedures</li>
<li>Implement data cleaning pipeline</li>
<li>Develop data enrichment processes</li>
</ol>
</section>
<section id="long-term-solutions" class="level3">
<h3 class="anchored" data-anchor-id="long-term-solutions">Long-term Solutions</h3>
<ol type="1">
<li>Establish data governance framework</li>
<li>Implement automated quality checks</li>
<li>Develop data quality metrics dashboard</li>
</ol>
</section>
</section>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<section id="a.-current-data-profile" class="level2">
<h2 class="anchored" data-anchor-id="a.-current-data-profile">A. Current Data Profile</h2>
<div class="cell" data-tbl-cap="Data Profile Summary" data-tbl-colwidths="[30,50]" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/raw_gdpr_data.json'</span>, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    fines_data <span class="op">=</span> json.load(f)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(fines_data)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert date to datetime</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'date'</span>])</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert amount to numeric</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'amount'</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">'amount'</span>].<span class="bu">str</span>.replace(<span class="st">'€'</span>, <span class="st">''</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>), errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Temporal Distribution</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>ax1.hist(df[<span class="st">'date'</span>], bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Distribution of Fines Over Time'</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Amount Distribution</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>ax2.hist(df[<span class="st">'amount'</span>].dropna(), bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Fine Amounts'</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Amount (€)'</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Country Distribution</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>country_counts <span class="op">=</span> df[<span class="st">'country'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>ax3.barh(country_counts.index, country_counts.values)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Top 10 Countries by Number of Fines'</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Article Distribution</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>article_counts <span class="op">=</span> df[<span class="st">'article'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>ax4.barh(article_counts.index, article_counts.values)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Top 10 Most Common Articles'</span>)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Create profile summary</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>profile_stats <span class="op">=</span> {</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Total Number of Fines'</span>,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Total Amount Fined'</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average Fine Amount'</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of Countries'</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of Unique Companies'</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Date Range'</span>,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Common Article'</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Active Country'</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">len</span>(df),</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'country'</span>].nunique(),</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'company'</span>].nunique(),</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'article'</span>].mode().iloc[<span class="dv">0</span>],</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'country'</span>].mode().iloc[<span class="dv">0</span>]</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>profile_df <span class="op">=</span> pd.DataFrame(profile_stats)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    profile_df.values.tolist(),</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>profile_df.columns.tolist(),</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data quality metrics</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>completeness <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> df.isnull().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>completeness_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Field'</span>: completeness.index,</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Completeness (%)'</span>: completeness.values.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    completeness_df.values.tolist(),</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>completeness_df.columns.tolist(),</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine Amount Statistics</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>amount_stats <span class="op">=</span> df[<span class="st">'amount'</span>].describe().<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>amount_stats_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Statistic'</span>: [<span class="st">'Count'</span>, <span class="st">'Mean'</span>, <span class="st">'Std Dev'</span>, <span class="st">'Min'</span>, <span class="st">'25%'</span>, <span class="st">'50%'</span>, <span class="st">'75%'</span>, <span class="st">'Max'</span>],</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value (€)'</span>: [</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>amount_stats[<span class="st">'count'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>,</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'mean'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'std'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'min'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'25%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'50%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'75%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'max'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>    amount_stats_df.values.tolist(),</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>amount_stats_df.columns.tolist(),</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional Fine Statistics</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>additional_stats <span class="op">=</span> {</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total Amount Fined'</span>: <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines &gt; €1M'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1_000_000</span>])<span class="sc">:,}</span><span class="ss">"</span>,</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines &gt; €10M'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">10_000_000</span>])<span class="sc">:,}</span><span class="ss">"</span>,</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Average Fine &gt; €1M'</span>: <span class="ss">f"€</span><span class="sc">{</span>df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1_000_000</span>][<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Percentage of Fines &lt; €100K'</span>: <span class="ss">f"</span><span class="sc">{</span>(<span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&lt;</span> <span class="dv">100_000</span>]) <span class="op">/</span> <span class="bu">len</span>(df) <span class="op">*</span> <span class="dv">100</span>)<span class="sc">:.1f}</span><span class="ss">%"</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>additional_stats_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: <span class="bu">list</span>(additional_stats.keys()),</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: <span class="bu">list</span>(additional_stats.values())</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>    additional_stats_df.values.tolist(),</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>additional_stats_df.columns.tolist(),</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/data-profile-output-1.png" id="data-profile-1" width="1431" height="1142" class="figure-img"></p>
</figure>
</div>
</div>
<div id="data-profile-2" class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<table class="caption-top table table-sm table-striped small">
<caption>Data Profile Summary</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total Amount Fined</td>
<td style="text-align: left;">€87,330,000.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of Fines &gt; €1M</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of Fines &gt; €10M</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Average Fine &gt; €1M</td>
<td style="text-align: left;">€3,250,000.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percentage of Fines &lt; €100K</td>
<td style="text-align: left;">40.0%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="b.-technical-details" class="level2">
<h2 class="anchored" data-anchor-id="b.-technical-details">B. Technical Details</h2>
<div class="cell" data-tbl-cap="Technical Details Summary" data-tbl-colwidths="[30,30,20,20]" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations for technical details</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Data Types Distribution</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data_types <span class="op">=</span> df.dtypes.value_counts()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ax1.bar(data_types.index.astype(<span class="bu">str</span>), data_types.values)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Distribution of Data Types'</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Data Type'</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.setp(ax1.get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Numeric Fields Distribution</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'int64'</span>, <span class="st">'float64'</span>]).columns</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    ax2.boxplot(df[col].dropna())</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Numeric Fields'</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Value'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Temporal Coverage</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>date_range <span class="op">=</span> pd.date_range(start<span class="op">=</span>df[<span class="st">'date'</span>].<span class="bu">min</span>(), end<span class="op">=</span>df[<span class="st">'date'</span>].<span class="bu">max</span>(), freq<span class="op">=</span><span class="st">'M'</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>date_counts <span class="op">=</span> df[<span class="st">'date'</span>].dt.to_period(<span class="st">'M'</span>).value_counts().sort_index()</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>ax3.plot(date_counts.index.astype(<span class="bu">str</span>), date_counts.values)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Temporal Coverage of Fines'</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>plt.setp(ax3.get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Missing Values Heatmap</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ax4.imshow(df.isnull(), aspect<span class="op">=</span><span class="st">'auto'</span>, cmap<span class="op">=</span><span class="st">'binary'</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Missing Values Pattern'</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Columns'</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Rows'</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Data type analysis</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>data_types_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Column'</span>: df.columns,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data Type'</span>: df.dtypes.astype(<span class="bu">str</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    data_types_df.values.tolist(),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>data_types_df.columns.tolist(),</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Value distributions</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>numeric_stats <span class="op">=</span> []</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'int64'</span>, <span class="st">'float64'</span>]).columns:</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> df[col].describe()</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    numeric_stats.append({</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Column'</span>: col,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Count'</span>: stats[<span class="st">'count'</span>],</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Mean'</span>: stats[<span class="st">'mean'</span>],</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Std'</span>: stats[<span class="st">'std'</span>],</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Min'</span>: stats[<span class="st">'min'</span>],</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">'25%'</span>: stats[<span class="st">'25%'</span>],</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">'50%'</span>: stats[<span class="st">'50%'</span>],</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'75%'</span>: stats[<span class="st">'75%'</span>],</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Max'</span>: stats[<span class="st">'max'</span>]</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>numeric_stats_df <span class="op">=</span> pd.DataFrame(numeric_stats)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>    numeric_stats_df.values.tolist(),</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>numeric_stats_df.columns.tolist(),</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Date range analysis</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>date_stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Earliest date'</span>, <span class="st">'Latest date'</span>, <span class="st">'Date range (days)'</span>],</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'date'</span>].<span class="bu">min</span>(),</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'date'</span>].<span class="bu">max</span>(),</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>        (df[<span class="st">'date'</span>].<span class="bu">max</span>() <span class="op">-</span> df[<span class="st">'date'</span>].<span class="bu">min</span>()).days</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>    date_stats.values.tolist(),</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>date_stats.columns.tolist(),</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/cx/vd32d1mj70dff2hfb1cyljc40000gn/T/ipykernel_69539/3140531953.py:20: FutureWarning:

'M' is deprecated and will be removed in a future version, please use 'ME' instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/technical-details-output-2.png" id="technical-details-1" width="1430" height="1142" class="figure-img"></p>
</figure>
</div>
</div>
<div id="technical-details-2" class="cell-output cell-output-display cell-output-markdown" data-execution_count="4">
<table class="caption-top table table-sm table-striped small">
<caption>Technical Details Summary</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Earliest date</td>
<td style="text-align: left;">2024-02-05 00:00:00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Latest date</td>
<td style="text-align: left;">2025-01-17 00:00:00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date range (days)</td>
<td style="text-align: left;">347</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="c.-country-level-details" class="level2">
<h2 class="anchored" data-anchor-id="c.-country-level-details">C. Country-Level Details</h2>
<div class="cell" data-tbl-cap="Country-Level Statistics" data-tbl-colwidths="[15,10,15,15,10,10,15,15,20]" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create enhanced visualizations for country-level analysis</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Number of fines by country</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>country_stats <span class="op">=</span> df.groupby(<span class="st">'country'</span>).agg({</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>],</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'company'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'article'</span>: [<span class="st">'nunique'</span>, <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>]]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>country_stats.columns <span class="op">=</span> [</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>, <span class="st">'Std Dev'</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Min Amount'</span>, <span class="st">'Max Amount'</span>, <span class="st">'Unique Companies'</span>, <span class="st">'Unique Articles'</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Most Common Article'</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Number of Fines'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Number of Fines by Country'</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Total amount by country</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Total Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Total Fine Amount by Country'</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Total Amount (€)'</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Average amount by country</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Average Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax3)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Average Fine Amount by Country'</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Average Amount (€)'</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Companies affected by country</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Unique Companies'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax4)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Number of Companies Affected by Country'</span>)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Number of Companies'</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate quality metrics by country</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>country_quality <span class="op">=</span> pd.DataFrame()</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Missing Values'</span>] <span class="op">=</span> df.groupby(<span class="st">'country'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>())</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Completeness Rate'</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> country_quality[<span class="st">'Missing Values'</span>] <span class="op">/</span> (<span class="bu">len</span>(df.columns) <span class="op">*</span> df.groupby(<span class="st">'country'</span>).size())) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Data Freshness'</span>] <span class="op">=</span> (pd.Timestamp.now() <span class="op">-</span> df.groupby(<span class="st">'country'</span>)[<span class="st">'date'</span>].<span class="bu">max</span>()).dt.days</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quality metrics visualization</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Completeness Rate'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Data Completeness by Country'</span>)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Completeness Rate (%)'</span>)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display country statistics</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    country_stats.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_stats.columns.tolist(),</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Display country quality metrics</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    country_quality.<span class="bu">round</span>(<span class="dv">2</span>).values.tolist(),</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_quality.columns.tolist(),</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/country-details-output-1.png" id="country-details-1" width="1431" height="1142" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/cx/vd32d1mj70dff2hfb1cyljc40000gn/T/ipykernel_69539/2549499068.py:41: DeprecationWarning:

DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/country-details-output-3.png" id="country-details-2" width="1143" height="566" class="figure-img"></p>
</figure>
</div>
</div>
<div id="country-details-3" class="cell-output cell-output-display cell-output-markdown" data-execution_count="5">
<table class="caption-top table table-sm table-striped small">
<caption>Country-Level Statistics</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Missing Values</th>
<th style="text-align: center;">Completeness Rate</th>
<th style="text-align: center;">Data Freshness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">373</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">320</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">85</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">198</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
</section>
<section id="next-chapter-preview" class="level1">
<h1>Next Chapter Preview</h1>
<p>The next chapter (Chapter 2) will provide a detailed breakdown of GDPR fines by categories and their distribution across countries. This will include:</p>
<ul>
<li>Analysis of fine categories and their frequencies</li>
<li>Geographic distribution of different violation types</li>
<li>Temporal trends in fine categories</li>
<li>Cross-country comparison of violation patterns</li>
<li>Impact analysis of different violation types</li>
</ul>
</section>
<section id="chapter-2-gdpr-fine-categories-analysis" class="level1">
<h1>Chapter 2: GDPR Fine Categories Analysis</h1>
<section id="overview-of-fine-categories" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-fine-categories">Overview of Fine Categories</h2>
<div id="cell-categories-overview" class="cell" data-tbl-cap="Article-Level Statistics" data-tbl-colwidths="[40,15,20,20]" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze article distribution</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>article_stats <span class="op">=</span> df.groupby(<span class="st">'article'</span>).agg({</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>article_stats.columns <span class="op">=</span> [<span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the amounts with Euro symbol and proper formatting</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>article_stats_formatted <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Article'</span>: article_stats.index,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines'</span>: article_stats[<span class="st">'Number of Fines'</span>],</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total Amount'</span>: article_stats[<span class="st">'Total Amount'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Average Amount'</span>: article_stats[<span class="st">'Average Amount'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display article statistics using tabulate</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    article_stats_formatted.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>[<span class="st">'Article'</span>, <span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>],</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top articles</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>article_counts <span class="op">=</span> df[<span class="st">'article'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>article_counts.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 Most Common GDPR Violations'</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Article'</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/categories-overview-output-1.png" id="categories-overview" width="1128" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="geographic-distribution-of-violations" class="level2">
<h2 class="anchored" data-anchor-id="geographic-distribution-of-violations">Geographic Distribution of Violations</h2>
<div class="cell" data-tbl-cap="Most Common Violations by Country" data-tbl-colwidths="[20,20,15,15]" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate violation counts by country</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>violation_counts <span class="op">=</span> df.groupby([<span class="st">'country'</span>, <span class="st">'article'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> violation_counts.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'article'</span>, values<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> violation_pct.fillna(<span class="dv">0</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> (violation_pct.div(violation_pct.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot for top violations</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>top_countries <span class="op">=</span> df[<span class="st">'country'</span>].value_counts().head(<span class="dv">10</span>).index</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>country_data <span class="op">=</span> violation_counts[violation_counts[<span class="st">'country'</span>].isin(top_countries)]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot stacked bar chart</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>pivot_data <span class="op">=</span> country_data.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'article'</span>, values<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>pivot_data.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of GDPR Violations by Country'</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Country'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Violations'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Article'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary statistics table</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>country_summary <span class="op">=</span> []</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> df[<span class="st">'country'</span>].unique():</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    country_data <span class="op">=</span> df[df[<span class="st">'country'</span>] <span class="op">==</span> country]</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    country_summary.append({</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Country'</span>: country,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Common Article'</span>: country_data[<span class="st">'article'</span>].mode().iloc[<span class="dv">0</span>],</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Highest Fine'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average Fine'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>country_summary_df <span class="op">=</span> pd.DataFrame(country_summary)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    country_summary_df.values.tolist(),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_summary_df.columns.tolist(),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="geographic-distribution-1" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1440x768 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/geographic-distribution-output-2.png" id="geographic-distribution-2" width="717" height="471" class="figure-img"></p>
</figure>
</div>
</div>
<div id="geographic-distribution-3" class="cell-output cell-output-display cell-output-markdown" data-execution_count="7">
<table class="caption-top table table-sm table-striped small">
<caption>Most Common Violations by Country</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Most Common Article</th>
<th style="text-align: left;">Highest Fine</th>
<th style="text-align: left;">Average Fine</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FRANCE</td>
<td style="text-align: left;">Art. 6 GDPR, Art. 14 GDPR, Art. L.34-5 CPCE</td>
<td style="text-align: left;">€525,000.00</td>
<td style="text-align: left;">€525,000.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">GREECE</td>
<td style="text-align: left;">Art. 5 (1) a) GDPR, Art. 6 (1) GDPR, Art. 14 GDPR</td>
<td style="text-align: left;">€400,000.00</td>
<td style="text-align: left;">€220,000.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPAIN</td>
<td style="text-align: left;">Art. 5 (1) f) GDPR</td>
<td style="text-align: left;">€3,500,000.00</td>
<td style="text-align: left;">€1,144,000.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNITED KINGDOM</td>
<td style="text-align: left;">Art. 5 (1) f) GDPR, Art. 32 (1), (2) GDPR</td>
<td style="text-align: left;">€904,000.00</td>
<td style="text-align: left;">€904,000.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="fine-amount-analysis-by-category" class="level2">
<h2 class="anchored" data-anchor-id="fine-amount-analysis-by-category">Fine Amount Analysis by Category</h2>
<div class="cell" data-tbl-cap="Fine Amount Statistics by Article" data-tbl-colwidths="[20,15,15,15,15,15]" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics by article</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>article_amount_stats <span class="op">=</span> df.groupby(<span class="st">'article'</span>).agg({</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'mean'</span>, <span class="st">'median'</span>, <span class="st">'std'</span>]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>article_amount_stats.columns <span class="op">=</span> [<span class="st">'Minimum'</span>, <span class="st">'Maximum'</span>, <span class="st">'Mean'</span>, <span class="st">'Median'</span>, <span class="st">'Std Dev'</span>]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the amounts with Euro symbol and proper formatting</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>article_amount_stats_formatted <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Article'</span>: article_amount_stats.index,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Minimum'</span>: article_amount_stats[<span class="st">'Minimum'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Maximum'</span>: article_amount_stats[<span class="st">'Maximum'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean'</span>: article_amount_stats[<span class="st">'Mean'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Median'</span>: article_amount_stats[<span class="st">'Median'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Std Dev'</span>: article_amount_stats[<span class="st">'Std Dev'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot of fine amounts by article</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>df.boxplot(column<span class="op">=</span><span class="st">'amount'</span>, by<span class="op">=</span><span class="st">'article'</span>, rot<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Fine Amounts by GDPR Article'</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">''</span>)  <span class="co"># Remove the default title</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Article'</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Fine Amount (€)'</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'log'</span>)  <span class="co"># Use log scale for better visualization</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Display statistics using tabulate</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    article_amount_stats_formatted.sort_values(<span class="st">'Mean'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>article_amount_stats_formatted.columns.tolist(),</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="amount-analysis-1" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1440x768 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/amount-analysis-output-2.png" id="amount-analysis-2" width="667" height="456" class="figure-img"></p>
</figure>
</div>
</div>
<div id="amount-analysis-3" class="cell-output cell-output-display cell-output-markdown" data-execution_count="8">
<table class="caption-top table table-sm table-striped small">
<caption>Fine Amount Statistics by Article</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Article</th>
<th style="text-align: left;">Minimum</th>
<th style="text-align: left;">Maximum</th>
<th style="text-align: left;">Mean</th>
<th style="text-align: left;">Median</th>
<th style="text-align: left;">Std Dev</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Art. 5 (1) f) GDPR</td>
<td style="text-align: left;">€8,000.00</td>
<td style="text-align: left;">€200,000.00</td>
<td style="text-align: left;">€91,000.00</td>
<td style="text-align: left;">€78,000.00</td>
<td style="text-align: left;">€70,010.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">Art. 5 (1) f) GDPR, Art. 32 (1), (2) GDPR</td>
<td style="text-align: left;">€904,000.00</td>
<td style="text-align: left;">€904,000.00</td>
<td style="text-align: left;">€904,000.00</td>
<td style="text-align: left;">€904,000.00</td>
<td style="text-align: left;">€0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Art. 6 GDPR, Art. 14 GDPR, Art. L.34-5 CPCE</td>
<td style="text-align: left;">€525,000.00</td>
<td style="text-align: left;">€525,000.00</td>
<td style="text-align: left;">€525,000.00</td>
<td style="text-align: left;">€525,000.00</td>
<td style="text-align: left;">€0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Art. 5 (1) f) GDPR, 32 GDPR, 25 (1) GDPR, 33 (3), (4), (5) GDPR</td>
<td style="text-align: left;">€400,000.00</td>
<td style="text-align: left;">€400,000.00</td>
<td style="text-align: left;">€400,000.00</td>
<td style="text-align: left;">€400,000.00</td>
<td style="text-align: left;">€0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Art. 5 (1) a) GDPR, Art. 6 (1) GDPR, Art. 14 GDPR</td>
<td style="text-align: left;">€40,000.00</td>
<td style="text-align: left;">€40,000.00</td>
<td style="text-align: left;">€40,000.00</td>
<td style="text-align: left;">€40,000.00</td>
<td style="text-align: left;">€0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Art. 5 (1) f) GDPR, Art. 32 GDPR</td>
<td style="text-align: left;">€3,000,000.00</td>
<td style="text-align: left;">€3,500,000.00</td>
<td style="text-align: left;">€3,250,000.00</td>
<td style="text-align: left;">€3,250,000.00</td>
<td style="text-align: left;">€256,494.59</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="chapter-3-market-and-country-analysis" class="level1">
<h1>Chapter 3: Market and Country Analysis</h1>
<section id="industry-classification" class="level2">
<h2 class="anchored" data-anchor-id="industry-classification">Industry Classification</h2>
<div id="cell-industry-analysis" class="cell" data-tbl-cap="Industry-Level Statistics" data-tbl-colwidths="[15,15,15,15,15,15]" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry classification (example categories)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>industry_categories <span class="op">=</span> {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Technology'</span>: [<span class="st">'tech'</span>, <span class="st">'software'</span>, <span class="st">'digital'</span>, <span class="st">'internet'</span>, <span class="st">'cloud'</span>],</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Finance'</span>: [<span class="st">'bank'</span>, <span class="st">'financial'</span>, <span class="st">'insurance'</span>, <span class="st">'credit'</span>],</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Healthcare'</span>: [<span class="st">'health'</span>, <span class="st">'medical'</span>, <span class="st">'hospital'</span>, <span class="st">'pharma'</span>],</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Retail'</span>: [<span class="st">'retail'</span>, <span class="st">'shop'</span>, <span class="st">'store'</span>, <span class="st">'e-commerce'</span>],</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Telecommunications'</span>: [<span class="st">'telecom'</span>, <span class="st">'mobile'</span>, <span class="st">'phone'</span>, <span class="st">'network'</span>],</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Other'</span>: []  <span class="co"># Default category</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify companies into industries</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_industry(company_name):</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    company_name <span class="op">=</span> <span class="bu">str</span>(company_name).lower()</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> industry, keywords <span class="kw">in</span> industry_categories.items():</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(keyword <span class="kw">in</span> company_name <span class="cf">for</span> keyword <span class="kw">in</span> keywords):</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> industry</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Other'</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'industry'</span>] <span class="op">=</span> df[<span class="st">'company'</span>].<span class="bu">apply</span>(classify_industry)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze industry distribution</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>industry_stats <span class="op">=</span> df.groupby(<span class="st">'industry'</span>).agg({</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>],</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'company'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'article'</span>: <span class="st">'nunique'</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>industry_stats.columns <span class="op">=</span> [<span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>, <span class="st">'Std Dev'</span>, <span class="st">'Unique Companies'</span>, <span class="st">'Unique Articles'</span>]</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display industry statistics</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    industry_stats.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>industry_stats.columns.tolist(),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Number of fines by industry</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>industry_stats[<span class="st">'Number of Fines'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Number of Fines by Industry'</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Total amount by industry</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>industry_stats[<span class="st">'Total Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Total Fine Amount by Industry'</span>)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Total Amount (€)'</span>)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/industry-analysis-output-1.png" id="industry-analysis" width="1430" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="country-market-analysis" class="level2">
<h2 class="anchored" data-anchor-id="country-market-analysis">Country-Market Analysis</h2>
<div class="cell" data-tbl-cap="Top Industries by Country" data-tbl-colwidths="[20,20,15,15]" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create country-industry cross-tabulation</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>country_industry <span class="op">=</span> pd.crosstab(df[<span class="st">'country'</span>], df[<span class="st">'industry'</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage distribution</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>country_industry_pct <span class="op">=</span> country_industry.div(country_industry.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap using matplotlib</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.imshow(country_industry_pct, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.colorbar(label<span class="op">=</span><span class="st">'Percentage'</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Fines by Country and Industry (%)'</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Industry'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Country'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.xticks(<span class="bu">range</span>(<span class="bu">len</span>(country_industry_pct.columns)), country_industry_pct.columns, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(country_industry_pct.index)), country_industry_pct.index)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table for top industries by country</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>country_industry_summary <span class="op">=</span> []</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> df[<span class="st">'country'</span>].unique():</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    country_data <span class="op">=</span> df[df[<span class="st">'country'</span>] <span class="op">==</span> country]</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    industry_dist <span class="op">=</span> country_data[<span class="st">'industry'</span>].value_counts()</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> industry, count <span class="kw">in</span> industry_dist.head(<span class="dv">3</span>).items():</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>        country_industry_summary.append({</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Country'</span>: country,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Industry'</span>: industry,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Number of Fines'</span>: count,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Amount'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[country_data[<span class="st">'industry'</span>] <span class="op">==</span> industry][<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>country_industry_df <span class="op">=</span> pd.DataFrame(country_industry_summary)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    country_industry_df.values.tolist(),</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_industry_df.columns.tolist(),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/country-market-output-1.png" id="country-market-1" width="1327" height="758" class="figure-img"></p>
</figure>
</div>
</div>
<div id="country-market-2" class="cell-output cell-output-display cell-output-markdown" data-execution_count="10">
<table class="caption-top table table-sm table-striped small">
<caption>Top Industries by Country</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Industry</th>
<th style="text-align: center;">Number of Fines</th>
<th style="text-align: left;">Total Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FRANCE</td>
<td style="text-align: left;">Retail</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;">€5,250,000.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">GREECE</td>
<td style="text-align: left;">Other</td>
<td style="text-align: center;">20</td>
<td style="text-align: left;">€4,400,000.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SPAIN</td>
<td style="text-align: left;">Other</td>
<td style="text-align: center;">60</td>
<td style="text-align: left;">€68,640,000.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNITED KINGDOM</td>
<td style="text-align: left;">Other</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;">€9,040,000.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="market-impact-analysis" class="level2">
<h2 class="anchored" data-anchor-id="market-impact-analysis">Market Impact Analysis</h2>
<div id="market-impact" class="cell" data-tbl-cap="Market Impact Analysis" data-tbl-colwidths="[20,15,15,15,20]" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate market impact metrics</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>market_impact <span class="op">=</span> pd.DataFrame()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Average fine by industry</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Average Fine'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'amount'</span>].mean()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine frequency by industry</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Fine Frequency'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>).size()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique companies affected</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Companies Affected'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'company'</span>].nunique()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Most common violations by industry</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Top Violation'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'article'</span>].agg(<span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>])</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display market impact statistics</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    market_impact.sort_values(<span class="st">'Average Fine'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>market_impact.columns.tolist(),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create impact visualization</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>market_impact[[<span class="st">'Average Fine'</span>, <span class="st">'Fine Frequency'</span>]].plot(kind<span class="op">=</span><span class="st">'bar'</span>, secondary_y<span class="op">=</span><span class="st">'Fine Frequency'</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Market Impact by Industry'</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Industry'</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Fine (€)'</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="market-impact-1" class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1152x576 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="DQ_files/figure-html/market-impact-output-2.png" id="market-impact-2" width="662" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Book 1 - Kidlens Law"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "If you write a problem down clearly, then the matter is half solved."</span>  </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; — Kidlens Law</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># Epilogue: The Art and Science of Data Analysis</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## A Day in the Life: The Six Thinking Hats of a Data Analyst</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>Let me tell you a story about Andi, a data analyst working on understanding GDPR compliance patterns. Her journey illustrates how modern data analysts combine analytical engineering with critical thinking using Edward de Bono's Six Thinking Hats approach and the DMAIC methodology.</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">### The White Hat: Facts and Information</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>Andi starts her day by gathering facts about GDPR fines across Europe. Like a detective, she collects raw data about fines, violations, and company responses. This is where analytical engineering begins - the systematic process of collecting, cleaning, and organizing data. She knows that good analysis starts with quality data, just as a good house needs a solid foundation.</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define: Project Charter, SIPOC Diagram</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Measure: Data Collection Plan, Operational Definitions</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analyze: Data Mining, Statistical Analysis</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Red Hat: Intuition and Feelings</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>As she dives into the data, Andi notices patterns that trigger her intuition. Some companies seem to repeatedly violate certain articles, while others quickly adapt after their first fine. She doesn't ignore these gut feelings - they're valuable indicators of where to look deeper. This emotional intelligence, combined with technical skills, makes a data analyst more than just a number cruncher.</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Measure: Voice of Customer (VOC)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analyze: Brainstorming</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve: Impact Analysis</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Black Hat: Critical Judgment</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>Andi puts on her critical thinking hat to identify potential issues. She asks tough questions:</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are there gaps in the data collection?</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Could there be biases in how different countries report violations?</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What limitations might affect our conclusions?</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>This cautious approach is essential in analytical engineering, where understanding data limitations is as important as the analysis itself.</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define: Risk Assessment</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Measure: Measurement System Analysis (MSA)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Control: Control Charts, Error Proofing</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Yellow Hat: Optimistic Opportunities</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>Looking at the bright side, Andi sees opportunities in the challenges:</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Patterns in the data could help companies prevent future violations</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analysis could lead to better compliance strategies</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Insights might help regulators focus their efforts more effectively</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>This optimistic perspective helps her frame the analysis in terms of solutions rather than just problems.</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve: Solution Selection Matrix</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Control: Process Control Plan</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define: Benefits Analysis</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Green Hat: Creative Solutions</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>Now comes the creative part. Andi combines different analytical approaches:</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualizing fine distributions to spot trends</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Creating interactive dashboards for stakeholders</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Developing automated quality checks for ongoing monitoring</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>This is where analytical engineering shines - using technical creativity to solve real business problems.</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analyze: Root Cause Analysis</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve: Design of Experiments (DOE)</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Control: Visual Management Systems</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Blue Hat: Process Control</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>Finally, Andi steps back to organize her thoughts and plan next steps:</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Document the analysis process for reproducibility</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Structure findings in a clear narrative</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plan future iterations and improvements</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>This systematic approach ensures that her work is not just insightful but also actionable and maintainable.</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>**DMAIC Tools Used:**</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Define: Project Management Plan</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Control: Documentation Systems</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve: Implementation Plan</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Modern Data Analyst</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>Today's data analyst is part detective, part engineer, and part storyteller. They:</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Build data pipelines that transform raw data into insights</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create automated processes for consistent analysis</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Develop visualizations that make complex patterns understandable</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tell stories that connect data to business decisions</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analytical Engineering in Practice</span></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>Analytical engineering is the bridge between raw data and business value. It involves:</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Designing robust data processing workflows</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Implementing quality control measures</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Creating reusable analysis components</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Building scalable solutions for growing data needs</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>This combination of technical skills and critical thinking enables data analysts to turn information into action, helping organizations make better decisions through data.</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: epilogue-visualization</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: The Data Analysis Journey</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [25,75]</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the stages of data analysis</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>analysis_stages <span class="op">=</span> {</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data Collection'</span>: <span class="st">'Gathering raw data from various sources, ensuring completeness and accuracy'</span>,</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quality Assessment'</span>: <span class="st">'Evaluating data quality, identifying issues, and implementing fixes'</span>,</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Processing &amp; Engineering'</span>: <span class="st">'Building pipelines and workflows for consistent analysis'</span>,</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Analysis &amp; Insights'</span>: <span class="st">'Discovering patterns and extracting meaningful insights'</span>,</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Visualization &amp; Communication'</span>: <span class="st">'Creating clear visualizations and compelling narratives'</span>,</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Action &amp; Implementation'</span>: <span class="st">'Turning insights into actionable recommendations'</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table showing the journey</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>journey_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stage'</span>: <span class="bu">list</span>(analysis_stages.keys()),</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Description'</span>: <span class="bu">list</span>(analysis_stages.values())</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table using tabulate</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>    journey_df.values.tolist(),</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>journey_df.columns.tolist(),</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="fu"># Executive Summary</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>This report presents a comprehensive assessment of data quality issues in the GDPR fines dataset. The analysis identifies critical quality concerns, their impact on data usability, and provides actionable recommendations for improvement. The findings from this chapter will be referenced throughout the subsequent analysis in <span class="co">[</span><span class="ot">Chapter 2</span><span class="co">](#chapter-2-gdpr-fine-categories-analysis)</span> and <span class="co">[</span><span class="ot">Chapter 3</span><span class="co">](#chapter-3-market-and-country-analysis)</span>.</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Findings</span></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Critical Issues**</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Missing values in key fields affecting 15% of records</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Inconsistent date formats in 8% of entries</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Duplicate entries identified in 5% of the dataset</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Outdated records (older than 2 years) in 12% of cases</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Country-Specific Concerns**</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Varying data quality standards across jurisdictions</span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Inconsistent reporting formats by country</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Delayed data updates in certain regions</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Integrity**</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Amount field contains invalid entries</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Article references show inconsistencies</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Company names lack standardization</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Quality Assessment</span></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quality Dimensions Overview</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: quality-dimensions</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Data Quality Assessment Framework</span></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [15,15,30,10,10,10]</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="co"># Define quality dimensions and metrics</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>quality_dimensions <span class="op">=</span> {</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Completeness'</span>: {</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Missing Values'</span>: <span class="st">'Percentage of null values in critical fields'</span>,</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Required Fields'</span>: <span class="st">'Presence of mandatory data elements'</span>,</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Coverage'</span>: <span class="st">'Geographic and temporal coverage'</span></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Accuracy'</span>: {</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Format Compliance'</span>: <span class="st">'Adherence to expected data formats'</span>,</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Value Range'</span>: <span class="st">'Values within expected ranges'</span>,</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Business Rules'</span>: <span class="st">'Compliance with domain-specific rules'</span></span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Consistency'</span>: {</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Cross-field Validation'</span>: <span class="st">'Logical relationships between fields'</span>,</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Temporal Consistency'</span>: <span class="st">'Chronological validity'</span>,</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Format Uniformity'</span>: <span class="st">'Standardized formats across records'</span></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Timeliness'</span>: {</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Freshness'</span>: <span class="st">'Age of most recent records'</span>,</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Update Frequency'</span>: <span class="st">'Regularity of data updates'</span>,</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Processing Delay'</span>: <span class="st">'Time between event and recording'</span></span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Integrity'</span>: {</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Referential Integrity'</span>: <span class="st">'Valid relationships between entities'</span>,</span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Data Lineage'</span>: <span class="st">'Traceability of data sources'</span>,</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Audit Trail'</span>: <span class="st">'Change history and version control'</span></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quality assessment table</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>assessment_data <span class="op">=</span> []</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dimension, metrics <span class="kw">in</span> quality_dimensions.items():</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metric, description <span class="kw">in</span> metrics.items():</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>        assessment_data.append({</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dimension'</span>: dimension,</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Metric'</span>: metric,</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Description'</span>: description,</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Status'</span>: <span class="st">'Critical'</span> <span class="cf">if</span> dimension <span class="kw">in</span> [<span class="st">'Completeness'</span>, <span class="st">'Accuracy'</span>] <span class="cf">else</span> <span class="st">'Moderate'</span>,</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Impact'</span>: <span class="st">'High'</span> <span class="cf">if</span> dimension <span class="kw">in</span> [<span class="st">'Completeness'</span>, <span class="st">'Accuracy'</span>] <span class="cf">else</span> <span class="st">'Medium'</span></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>assessment_df <span class="op">=</span> pd.DataFrame(assessment_data)</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Add severity scoring</span></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>assessment_df[<span class="st">'Severity Score'</span>] <span class="op">=</span> assessment_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">3</span> <span class="cf">if</span> x[<span class="st">'Status'</span>] <span class="op">==</span> <span class="st">'Critical'</span> <span class="cf">else</span> <span class="dv">2</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Severity by Dimension</span></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>dimension_scores <span class="op">=</span> assessment_df.groupby(<span class="st">'Dimension'</span>)[<span class="st">'Severity Score'</span>].mean().sort_values()</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>ax1.barh(dimension_scores.index, dimension_scores.values)</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Data Quality Severity by Dimension'</span>)</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Severity Score'</span>)</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>ax1.set_xlim(<span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Impact Distribution</span></span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>impact_counts <span class="op">=</span> assessment_df[<span class="st">'Impact'</span>].value_counts()</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>ax2.bar(impact_counts.index, impact_counts.values)</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Impact Levels'</span>)</span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Impact Level'</span>)</span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Display formatted assessment table using tabulate with custom styling</span></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>table_data <span class="op">=</span> assessment_df.values.tolist()</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> assessment_df.columns.tolist()</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>    table_data,</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>headers,</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Critical Issues Analysis</span></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Completeness Issues</span></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Missing Values**: 15% of records have missing critical fields</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Impact**: Affects trend analysis and reporting accuracy</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recommendation**: Implement automated validation for mandatory fields</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Accuracy Concerns</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Format Inconsistencies**: 8% of dates and amounts have format issues</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Impact**: Compromises data analysis and aggregation</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recommendation**: Standardize data collection procedures</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Consistency Problems</span></span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Duplicate Entries**: 5% of records are potential duplicates</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Impact**: Skews statistical analysis and reporting</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recommendation**: Implement deduplication process</span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Timeliness Gaps</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Data Freshness**: 12% of records are outdated</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Impact**: Reduces relevance for current analysis</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recommendation**: Establish regular update schedule</span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recommendations</span></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Immediate Actions</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Implement automated validation for critical fields</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Establish data quality monitoring system</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Create data quality dashboard</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a><span class="fu">### Short-term Improvements</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Standardize data collection procedures</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Implement data cleaning pipeline</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Develop data enrichment processes</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="fu">### Long-term Solutions</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Establish data governance framework</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Implement automated quality checks</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Develop data quality metrics dashboard</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## A. Current Data Profile</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data-profile</span></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Data Profile Summary</span></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [30,50]</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/raw_gdpr_data.json'</span>, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>    fines_data <span class="op">=</span> json.load(f)</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to DataFrame</span></span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(fines_data)</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert date to datetime</span></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'date'</span>])</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert amount to numeric</span></span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'amount'</span>] <span class="op">=</span> pd.to_numeric(df[<span class="st">'amount'</span>].<span class="bu">str</span>.replace(<span class="st">'€'</span>, <span class="st">''</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>), errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Temporal Distribution</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>ax1.hist(df[<span class="st">'date'</span>], bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Distribution of Fines Over Time'</span>)</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Amount Distribution</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>ax2.hist(df[<span class="st">'amount'</span>].dropna(), bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Fine Amounts'</span>)</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Amount (€)'</span>)</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Country Distribution</span></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>country_counts <span class="op">=</span> df[<span class="st">'country'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>ax3.barh(country_counts.index, country_counts.values)</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Top 10 Countries by Number of Fines'</span>)</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Article Distribution</span></span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>article_counts <span class="op">=</span> df[<span class="st">'article'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>ax4.barh(article_counts.index, article_counts.values)</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Top 10 Most Common Articles'</span>)</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Create profile summary</span></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>profile_stats <span class="op">=</span> {</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Total Number of Fines'</span>,</span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Total Amount Fined'</span>,</span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average Fine Amount'</span>,</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of Countries'</span>,</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Number of Unique Companies'</span>,</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Date Range'</span>,</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Common Article'</span>,</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Active Country'</span></span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [</span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>        <span class="bu">len</span>(df),</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'country'</span>].nunique(),</span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'company'</span>].nunique(),</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>df[<span class="st">'date'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'article'</span>].mode().iloc[<span class="dv">0</span>],</span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'country'</span>].mode().iloc[<span class="dv">0</span>]</span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>profile_df <span class="op">=</span> pd.DataFrame(profile_stats)</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a>    profile_df.values.tolist(),</span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>profile_df.columns.tolist(),</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data quality metrics</span></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>completeness <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> df.isnull().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a>completeness_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Field'</span>: completeness.index,</span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Completeness (%)'</span>: completeness.values.<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>    completeness_df.values.tolist(),</span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>completeness_df.columns.tolist(),</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine Amount Statistics</span></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>amount_stats <span class="op">=</span> df[<span class="st">'amount'</span>].describe().<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a>amount_stats_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Statistic'</span>: [<span class="st">'Count'</span>, <span class="st">'Mean'</span>, <span class="st">'Std Dev'</span>, <span class="st">'Min'</span>, <span class="st">'25%'</span>, <span class="st">'50%'</span>, <span class="st">'75%'</span>, <span class="st">'Max'</span>],</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value (€)'</span>: [</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>amount_stats[<span class="st">'count'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>,</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'mean'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'std'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'min'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'25%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'50%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'75%'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"€</span><span class="sc">{</span>amount_stats[<span class="st">'max'</span>]<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>    amount_stats_df.values.tolist(),</span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>amount_stats_df.columns.tolist(),</span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional Fine Statistics</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a>additional_stats <span class="op">=</span> {</span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total Amount Fined'</span>: <span class="ss">f"€</span><span class="sc">{</span>df[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines &gt; €1M'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1_000_000</span>])<span class="sc">:,}</span><span class="ss">"</span>,</span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines &gt; €10M'</span>: <span class="ss">f"</span><span class="sc">{</span><span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">10_000_000</span>])<span class="sc">:,}</span><span class="ss">"</span>,</span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Average Fine &gt; €1M'</span>: <span class="ss">f"€</span><span class="sc">{</span>df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1_000_000</span>][<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Percentage of Fines &lt; €100K'</span>: <span class="ss">f"</span><span class="sc">{</span>(<span class="bu">len</span>(df[df[<span class="st">'amount'</span>] <span class="op">&lt;</span> <span class="dv">100_000</span>]) <span class="op">/</span> <span class="bu">len</span>(df) <span class="op">*</span> <span class="dv">100</span>)<span class="sc">:.1f}</span><span class="ss">%"</span></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>additional_stats_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: <span class="bu">list</span>(additional_stats.keys()),</span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: <span class="bu">list</span>(additional_stats.values())</span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a>    additional_stats_df.values.tolist(),</span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>additional_stats_df.columns.tolist(),</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## B. Technical Details</span></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: technical-details</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Technical Details Summary</span></span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [30,30,20,20]</span></span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations for technical details</span></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Data Types Distribution</span></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a>data_types <span class="op">=</span> df.dtypes.value_counts()</span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a>ax1.bar(data_types.index.astype(<span class="bu">str</span>), data_types.values)</span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Distribution of Data Types'</span>)</span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Data Type'</span>)</span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a>plt.setp(ax1.get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Numeric Fields Distribution</span></span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'int64'</span>, <span class="st">'float64'</span>]).columns</span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_cols:</span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>    ax2.boxplot(df[col].dropna())</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Distribution of Numeric Fields'</span>)</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Value'</span>)</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Temporal Coverage</span></span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>date_range <span class="op">=</span> pd.date_range(start<span class="op">=</span>df[<span class="st">'date'</span>].<span class="bu">min</span>(), end<span class="op">=</span>df[<span class="st">'date'</span>].<span class="bu">max</span>(), freq<span class="op">=</span><span class="st">'M'</span>)</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a>date_counts <span class="op">=</span> df[<span class="st">'date'</span>].dt.to_period(<span class="st">'M'</span>).value_counts().sort_index()</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a>ax3.plot(date_counts.index.astype(<span class="bu">str</span>), date_counts.values)</span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Temporal Coverage of Fines'</span>)</span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a>plt.setp(ax3.get_xticklabels(), rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Missing Values Heatmap</span></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a>ax4.imshow(df.isnull(), aspect<span class="op">=</span><span class="st">'auto'</span>, cmap<span class="op">=</span><span class="st">'binary'</span>)</span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Missing Values Pattern'</span>)</span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Columns'</span>)</span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Rows'</span>)</span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Data type analysis</span></span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a>data_types_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Column'</span>: df.columns,</span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Data Type'</span>: df.dtypes.astype(<span class="bu">str</span>)</span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a>    data_types_df.values.tolist(),</span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>data_types_df.columns.tolist(),</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Value distributions</span></span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a>numeric_stats <span class="op">=</span> []</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">'int64'</span>, <span class="st">'float64'</span>]).columns:</span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>    stats <span class="op">=</span> df[col].describe()</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>    numeric_stats.append({</span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Column'</span>: col,</span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Count'</span>: stats[<span class="st">'count'</span>],</span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Mean'</span>: stats[<span class="st">'mean'</span>],</span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Std'</span>: stats[<span class="st">'std'</span>],</span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Min'</span>: stats[<span class="st">'min'</span>],</span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>        <span class="st">'25%'</span>: stats[<span class="st">'25%'</span>],</span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a>        <span class="st">'50%'</span>: stats[<span class="st">'50%'</span>],</span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a>        <span class="st">'75%'</span>: stats[<span class="st">'75%'</span>],</span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Max'</span>: stats[<span class="st">'max'</span>]</span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>numeric_stats_df <span class="op">=</span> pd.DataFrame(numeric_stats)</span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a>    numeric_stats_df.values.tolist(),</span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>numeric_stats_df.columns.tolist(),</span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a><span class="co"># Date range analysis</span></span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a>date_stats <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Earliest date'</span>, <span class="st">'Latest date'</span>, <span class="st">'Date range (days)'</span>],</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [</span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'date'</span>].<span class="bu">min</span>(),</span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'date'</span>].<span class="bu">max</span>(),</span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>        (df[<span class="st">'date'</span>].<span class="bu">max</span>() <span class="op">-</span> df[<span class="st">'date'</span>].<span class="bu">min</span>()).days</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>    date_stats.values.tolist(),</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>date_stats.columns.tolist(),</span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a><span class="fu">## C. Country-Level Details</span></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: country-details</span></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Country-Level Statistics</span></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [15,10,15,15,10,10,15,15,20]</span></span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Create enhanced visualizations for country-level analysis</span></span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">12</span>))</span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Number of fines by country</span></span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a>country_stats <span class="op">=</span> df.groupby(<span class="st">'country'</span>).agg({</span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'max'</span>],</span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a>    <span class="st">'company'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a>    <span class="st">'article'</span>: [<span class="st">'nunique'</span>, <span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>]]</span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a>country_stats.columns <span class="op">=</span> [</span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>, <span class="st">'Std Dev'</span>, </span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Min Amount'</span>, <span class="st">'Max Amount'</span>, <span class="st">'Unique Companies'</span>, <span class="st">'Unique Articles'</span>,</span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Most Common Article'</span></span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Number of Fines'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Number of Fines by Country'</span>)</span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Total amount by country</span></span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Total Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Total Fine Amount by Country'</span>)</span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Total Amount (€)'</span>)</span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Average amount by country</span></span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Average Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax3)</span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Average Fine Amount by Country'</span>)</span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Average Amount (€)'</span>)</span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Companies affected by country</span></span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a>country_stats[<span class="st">'Unique Companies'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax4)</span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Number of Companies Affected by Country'</span>)</span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Number of Companies'</span>)</span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate quality metrics by country</span></span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a>country_quality <span class="op">=</span> pd.DataFrame()</span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Missing Values'</span>] <span class="op">=</span> df.groupby(<span class="st">'country'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>())</span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Completeness Rate'</span>] <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> country_quality[<span class="st">'Missing Values'</span>] <span class="op">/</span> (<span class="bu">len</span>(df.columns) <span class="op">*</span> df.groupby(<span class="st">'country'</span>).size())) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Data Freshness'</span>] <span class="op">=</span> (pd.Timestamp.now() <span class="op">-</span> df.groupby(<span class="st">'country'</span>)[<span class="st">'date'</span>].<span class="bu">max</span>()).dt.days</span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quality metrics visualization</span></span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a>country_quality[<span class="st">'Completeness Rate'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>)</span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Data Completeness by Country'</span>)</span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Completeness Rate (%)'</span>)</span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Display country statistics</span></span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a>    country_stats.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_stats.columns.tolist(),</span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Display country quality metrics</span></span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a>    country_quality.<span class="bu">round</span>(<span class="dv">2</span>).values.tolist(),</span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_quality.columns.tolist(),</span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a><span class="fu"># Next Chapter Preview</span></span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a>The next chapter (Chapter 2) will provide a detailed breakdown of GDPR fines by categories and their distribution across countries. This will include:</span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analysis of fine categories and their frequencies</span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Geographic distribution of different violation types</span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Temporal trends in fine categories</span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cross-country comparison of violation patterns</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Impact analysis of different violation types</span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 2: GDPR Fine Categories Analysis</span></span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview of Fine Categories</span></span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: categories-overview</span></span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Article-Level Statistics</span></span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [40,15,20,20]</span></span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze article distribution</span></span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a>article_stats <span class="op">=</span> df.groupby(<span class="st">'article'</span>).agg({</span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>]</span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a>article_stats.columns <span class="op">=</span> [<span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>]</span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the amounts with Euro symbol and proper formatting</span></span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a>article_stats_formatted <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Article'</span>: article_stats.index,</span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Number of Fines'</span>: article_stats[<span class="st">'Number of Fines'</span>],</span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total Amount'</span>: article_stats[<span class="st">'Total Amount'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Average Amount'</span>: article_stats[<span class="st">'Average Amount'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a><span class="co"># Display article statistics using tabulate</span></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a>    article_stats_formatted.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>[<span class="st">'Article'</span>, <span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>],</span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top articles</span></span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a>article_counts <span class="op">=</span> df[<span class="st">'article'</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a>article_counts.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Top 10 Most Common GDPR Violations'</span>)</span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Article'</span>)</span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Geographic Distribution of Violations</span></span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: geographic-distribution</span></span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Most Common Violations by Country</span></span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [20,20,15,15]</span></span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate violation counts by country</span></span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a>violation_counts <span class="op">=</span> df.groupby([<span class="st">'country'</span>, <span class="st">'article'</span>]).size().reset_index(name<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> violation_counts.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'article'</span>, values<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> violation_pct.fillna(<span class="dv">0</span>)</span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a>violation_pct <span class="op">=</span> (violation_pct.div(violation_pct.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar plot for top violations</span></span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a>top_countries <span class="op">=</span> df[<span class="st">'country'</span>].value_counts().head(<span class="dv">10</span>).index</span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a>country_data <span class="op">=</span> violation_counts[violation_counts[<span class="st">'country'</span>].isin(top_countries)]</span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot stacked bar chart</span></span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a>pivot_data <span class="op">=</span> country_data.pivot(index<span class="op">=</span><span class="st">'country'</span>, columns<span class="op">=</span><span class="st">'article'</span>, values<span class="op">=</span><span class="st">'count'</span>)</span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a>pivot_data.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of GDPR Violations by Country'</span>)</span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Country'</span>)</span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Violations'</span>)</span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Article'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary statistics table</span></span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a>country_summary <span class="op">=</span> []</span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> df[<span class="st">'country'</span>].unique():</span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a>    country_data <span class="op">=</span> df[df[<span class="st">'country'</span>] <span class="op">==</span> country]</span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a>    country_summary.append({</span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Country'</span>: country,</span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Most Common Article'</span>: country_data[<span class="st">'article'</span>].mode().iloc[<span class="dv">0</span>],</span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Highest Fine'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>,</span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Average Fine'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[<span class="st">'amount'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-731"><a href="#cb17-731" aria-hidden="true" tabindex="-1"></a>country_summary_df <span class="op">=</span> pd.DataFrame(country_summary)</span>
<span id="cb17-732"><a href="#cb17-732" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a>    country_summary_df.values.tolist(),</span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_summary_df.columns.tolist(),</span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fine Amount Analysis by Category</span></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: amount-analysis</span></span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Fine Amount Statistics by Article</span></span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [20,15,15,15,15,15]</span></span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics by article</span></span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a>article_amount_stats <span class="op">=</span> df.groupby(<span class="st">'article'</span>).agg({</span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'min'</span>, <span class="st">'max'</span>, <span class="st">'mean'</span>, <span class="st">'median'</span>, <span class="st">'std'</span>]</span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-754"><a href="#cb17-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-755"><a href="#cb17-755" aria-hidden="true" tabindex="-1"></a>article_amount_stats.columns <span class="op">=</span> [<span class="st">'Minimum'</span>, <span class="st">'Maximum'</span>, <span class="st">'Mean'</span>, <span class="st">'Median'</span>, <span class="st">'Std Dev'</span>]</span>
<span id="cb17-756"><a href="#cb17-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-757"><a href="#cb17-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the amounts with Euro symbol and proper formatting</span></span>
<span id="cb17-758"><a href="#cb17-758" aria-hidden="true" tabindex="-1"></a>article_amount_stats_formatted <span class="op">=</span> pd.DataFrame({</span>
<span id="cb17-759"><a href="#cb17-759" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Article'</span>: article_amount_stats.index,</span>
<span id="cb17-760"><a href="#cb17-760" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Minimum'</span>: article_amount_stats[<span class="st">'Minimum'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb17-761"><a href="#cb17-761" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Maximum'</span>: article_amount_stats[<span class="st">'Maximum'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb17-762"><a href="#cb17-762" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mean'</span>: article_amount_stats[<span class="st">'Mean'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb17-763"><a href="#cb17-763" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Median'</span>: article_amount_stats[<span class="st">'Median'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>),</span>
<span id="cb17-764"><a href="#cb17-764" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Std Dev'</span>: article_amount_stats[<span class="st">'Std Dev'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f"€</span><span class="sc">{</span>x<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb17-765"><a href="#cb17-765" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-766"><a href="#cb17-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-767"><a href="#cb17-767" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot of fine amounts by article</span></span>
<span id="cb17-768"><a href="#cb17-768" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb17-769"><a href="#cb17-769" aria-hidden="true" tabindex="-1"></a>df.boxplot(column<span class="op">=</span><span class="st">'amount'</span>, by<span class="op">=</span><span class="st">'article'</span>, rot<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Fine Amounts by GDPR Article'</span>)</span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">''</span>)  <span class="co"># Remove the default title</span></span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Article'</span>)</span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Fine Amount (€)'</span>)</span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">'log'</span>)  <span class="co"># Use log scale for better visualization</span></span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a><span class="co"># Display statistics using tabulate</span></span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a>    article_amount_stats_formatted.sort_values(<span class="st">'Mean'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb17-781"><a href="#cb17-781" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>article_amount_stats_formatted.columns.tolist(),</span>
<span id="cb17-782"><a href="#cb17-782" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-783"><a href="#cb17-783" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-784"><a href="#cb17-784" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-785"><a href="#cb17-785" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-786"><a href="#cb17-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-788"><a href="#cb17-788" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter 3: Market and Country Analysis</span></span>
<span id="cb17-789"><a href="#cb17-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-790"><a href="#cb17-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## Industry Classification</span></span>
<span id="cb17-791"><a href="#cb17-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-794"><a href="#cb17-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-795"><a href="#cb17-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: industry-analysis</span></span>
<span id="cb17-796"><a href="#cb17-796" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Industry-Level Statistics</span></span>
<span id="cb17-797"><a href="#cb17-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [15,15,15,15,15,15]</span></span>
<span id="cb17-798"><a href="#cb17-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry classification (example categories)</span></span>
<span id="cb17-799"><a href="#cb17-799" aria-hidden="true" tabindex="-1"></a>industry_categories <span class="op">=</span> {</span>
<span id="cb17-800"><a href="#cb17-800" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Technology'</span>: [<span class="st">'tech'</span>, <span class="st">'software'</span>, <span class="st">'digital'</span>, <span class="st">'internet'</span>, <span class="st">'cloud'</span>],</span>
<span id="cb17-801"><a href="#cb17-801" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Finance'</span>: [<span class="st">'bank'</span>, <span class="st">'financial'</span>, <span class="st">'insurance'</span>, <span class="st">'credit'</span>],</span>
<span id="cb17-802"><a href="#cb17-802" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Healthcare'</span>: [<span class="st">'health'</span>, <span class="st">'medical'</span>, <span class="st">'hospital'</span>, <span class="st">'pharma'</span>],</span>
<span id="cb17-803"><a href="#cb17-803" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Retail'</span>: [<span class="st">'retail'</span>, <span class="st">'shop'</span>, <span class="st">'store'</span>, <span class="st">'e-commerce'</span>],</span>
<span id="cb17-804"><a href="#cb17-804" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Telecommunications'</span>: [<span class="st">'telecom'</span>, <span class="st">'mobile'</span>, <span class="st">'phone'</span>, <span class="st">'network'</span>],</span>
<span id="cb17-805"><a href="#cb17-805" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Other'</span>: []  <span class="co"># Default category</span></span>
<span id="cb17-806"><a href="#cb17-806" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-807"><a href="#cb17-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify companies into industries</span></span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_industry(company_name):</span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a>    company_name <span class="op">=</span> <span class="bu">str</span>(company_name).lower()</span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> industry, keywords <span class="kw">in</span> industry_categories.items():</span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(keyword <span class="kw">in</span> company_name <span class="cf">for</span> keyword <span class="kw">in</span> keywords):</span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> industry</span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Other'</span></span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'industry'</span>] <span class="op">=</span> df[<span class="st">'company'</span>].<span class="bu">apply</span>(classify_industry)</span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze industry distribution</span></span>
<span id="cb17-819"><a href="#cb17-819" aria-hidden="true" tabindex="-1"></a>industry_stats <span class="op">=</span> df.groupby(<span class="st">'industry'</span>).agg({</span>
<span id="cb17-820"><a href="#cb17-820" aria-hidden="true" tabindex="-1"></a>    <span class="st">'amount'</span>: [<span class="st">'count'</span>, <span class="st">'sum'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>],</span>
<span id="cb17-821"><a href="#cb17-821" aria-hidden="true" tabindex="-1"></a>    <span class="st">'company'</span>: <span class="st">'nunique'</span>,</span>
<span id="cb17-822"><a href="#cb17-822" aria-hidden="true" tabindex="-1"></a>    <span class="st">'article'</span>: <span class="st">'nunique'</span></span>
<span id="cb17-823"><a href="#cb17-823" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb17-824"><a href="#cb17-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-825"><a href="#cb17-825" aria-hidden="true" tabindex="-1"></a>industry_stats.columns <span class="op">=</span> [<span class="st">'Number of Fines'</span>, <span class="st">'Total Amount'</span>, <span class="st">'Average Amount'</span>, <span class="st">'Std Dev'</span>, <span class="st">'Unique Companies'</span>, <span class="st">'Unique Articles'</span>]</span>
<span id="cb17-826"><a href="#cb17-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-827"><a href="#cb17-827" aria-hidden="true" tabindex="-1"></a><span class="co"># Display industry statistics</span></span>
<span id="cb17-828"><a href="#cb17-828" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-829"><a href="#cb17-829" aria-hidden="true" tabindex="-1"></a>    industry_stats.sort_values(<span class="st">'Total Amount'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb17-830"><a href="#cb17-830" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>industry_stats.columns.tolist(),</span>
<span id="cb17-831"><a href="#cb17-831" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-832"><a href="#cb17-832" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-833"><a href="#cb17-833" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-834"><a href="#cb17-834" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-835"><a href="#cb17-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-836"><a href="#cb17-836" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations</span></span>
<span id="cb17-837"><a href="#cb17-837" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb17-838"><a href="#cb17-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-839"><a href="#cb17-839" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Number of fines by industry</span></span>
<span id="cb17-840"><a href="#cb17-840" aria-hidden="true" tabindex="-1"></a>industry_stats[<span class="st">'Number of Fines'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb17-841"><a href="#cb17-841" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Number of Fines by Industry'</span>)</span>
<span id="cb17-842"><a href="#cb17-842" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Number of Fines'</span>)</span>
<span id="cb17-843"><a href="#cb17-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-844"><a href="#cb17-844" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Total amount by industry</span></span>
<span id="cb17-845"><a href="#cb17-845" aria-hidden="true" tabindex="-1"></a>industry_stats[<span class="st">'Total Amount'</span>].sort_values(ascending<span class="op">=</span><span class="va">True</span>).plot(kind<span class="op">=</span><span class="st">'barh'</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb17-846"><a href="#cb17-846" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Total Fine Amount by Industry'</span>)</span>
<span id="cb17-847"><a href="#cb17-847" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Total Amount (€)'</span>)</span>
<span id="cb17-848"><a href="#cb17-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-849"><a href="#cb17-849" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-850"><a href="#cb17-850" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-851"><a href="#cb17-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-852"><a href="#cb17-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-853"><a href="#cb17-853" aria-hidden="true" tabindex="-1"></a><span class="fu">## Country-Market Analysis</span></span>
<span id="cb17-854"><a href="#cb17-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-857"><a href="#cb17-857" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-858"><a href="#cb17-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: country-market</span></span>
<span id="cb17-859"><a href="#cb17-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Top Industries by Country</span></span>
<span id="cb17-860"><a href="#cb17-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [20,20,15,15]</span></span>
<span id="cb17-861"><a href="#cb17-861" aria-hidden="true" tabindex="-1"></a><span class="co"># Create country-industry cross-tabulation</span></span>
<span id="cb17-862"><a href="#cb17-862" aria-hidden="true" tabindex="-1"></a>country_industry <span class="op">=</span> pd.crosstab(df[<span class="st">'country'</span>], df[<span class="st">'industry'</span>])</span>
<span id="cb17-863"><a href="#cb17-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-864"><a href="#cb17-864" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage distribution</span></span>
<span id="cb17-865"><a href="#cb17-865" aria-hidden="true" tabindex="-1"></a>country_industry_pct <span class="op">=</span> country_industry.div(country_industry.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-866"><a href="#cb17-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-867"><a href="#cb17-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap using matplotlib</span></span>
<span id="cb17-868"><a href="#cb17-868" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb17-869"><a href="#cb17-869" aria-hidden="true" tabindex="-1"></a>plt.imshow(country_industry_pct, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>)</span>
<span id="cb17-870"><a href="#cb17-870" aria-hidden="true" tabindex="-1"></a>plt.colorbar(label<span class="op">=</span><span class="st">'Percentage'</span>)</span>
<span id="cb17-871"><a href="#cb17-871" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of Fines by Country and Industry (%)'</span>)</span>
<span id="cb17-872"><a href="#cb17-872" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Industry'</span>)</span>
<span id="cb17-873"><a href="#cb17-873" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Country'</span>)</span>
<span id="cb17-874"><a href="#cb17-874" aria-hidden="true" tabindex="-1"></a>plt.xticks(<span class="bu">range</span>(<span class="bu">len</span>(country_industry_pct.columns)), country_industry_pct.columns, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb17-875"><a href="#cb17-875" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(country_industry_pct.index)), country_industry_pct.index)</span>
<span id="cb17-876"><a href="#cb17-876" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-877"><a href="#cb17-877" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-878"><a href="#cb17-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-879"><a href="#cb17-879" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table for top industries by country</span></span>
<span id="cb17-880"><a href="#cb17-880" aria-hidden="true" tabindex="-1"></a>country_industry_summary <span class="op">=</span> []</span>
<span id="cb17-881"><a href="#cb17-881" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country <span class="kw">in</span> df[<span class="st">'country'</span>].unique():</span>
<span id="cb17-882"><a href="#cb17-882" aria-hidden="true" tabindex="-1"></a>    country_data <span class="op">=</span> df[df[<span class="st">'country'</span>] <span class="op">==</span> country]</span>
<span id="cb17-883"><a href="#cb17-883" aria-hidden="true" tabindex="-1"></a>    industry_dist <span class="op">=</span> country_data[<span class="st">'industry'</span>].value_counts()</span>
<span id="cb17-884"><a href="#cb17-884" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> industry, count <span class="kw">in</span> industry_dist.head(<span class="dv">3</span>).items():</span>
<span id="cb17-885"><a href="#cb17-885" aria-hidden="true" tabindex="-1"></a>        country_industry_summary.append({</span>
<span id="cb17-886"><a href="#cb17-886" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Country'</span>: country,</span>
<span id="cb17-887"><a href="#cb17-887" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Industry'</span>: industry,</span>
<span id="cb17-888"><a href="#cb17-888" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Number of Fines'</span>: count,</span>
<span id="cb17-889"><a href="#cb17-889" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Amount'</span>: <span class="ss">f"€</span><span class="sc">{</span>country_data[country_data[<span class="st">'industry'</span>] <span class="op">==</span> industry][<span class="st">'amount'</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">:,.2f}</span><span class="ss">"</span></span>
<span id="cb17-890"><a href="#cb17-890" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb17-891"><a href="#cb17-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-892"><a href="#cb17-892" aria-hidden="true" tabindex="-1"></a>country_industry_df <span class="op">=</span> pd.DataFrame(country_industry_summary)</span>
<span id="cb17-893"><a href="#cb17-893" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-894"><a href="#cb17-894" aria-hidden="true" tabindex="-1"></a>    country_industry_df.values.tolist(),</span>
<span id="cb17-895"><a href="#cb17-895" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>country_industry_df.columns.tolist(),</span>
<span id="cb17-896"><a href="#cb17-896" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-897"><a href="#cb17-897" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-898"><a href="#cb17-898" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-899"><a href="#cb17-899" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-900"><a href="#cb17-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-901"><a href="#cb17-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-902"><a href="#cb17-902" aria-hidden="true" tabindex="-1"></a><span class="fu">## Market Impact Analysis</span></span>
<span id="cb17-903"><a href="#cb17-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-906"><a href="#cb17-906" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-907"><a href="#cb17-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: market-impact</span></span>
<span id="cb17-908"><a href="#cb17-908" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Market Impact Analysis</span></span>
<span id="cb17-909"><a href="#cb17-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-colwidths: [20,15,15,15,20]</span></span>
<span id="cb17-910"><a href="#cb17-910" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate market impact metrics</span></span>
<span id="cb17-911"><a href="#cb17-911" aria-hidden="true" tabindex="-1"></a>market_impact <span class="op">=</span> pd.DataFrame()</span>
<span id="cb17-912"><a href="#cb17-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-913"><a href="#cb17-913" aria-hidden="true" tabindex="-1"></a><span class="co"># Average fine by industry</span></span>
<span id="cb17-914"><a href="#cb17-914" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Average Fine'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'amount'</span>].mean()</span>
<span id="cb17-915"><a href="#cb17-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-916"><a href="#cb17-916" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine frequency by industry</span></span>
<span id="cb17-917"><a href="#cb17-917" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Fine Frequency'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>).size()</span>
<span id="cb17-918"><a href="#cb17-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-919"><a href="#cb17-919" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique companies affected</span></span>
<span id="cb17-920"><a href="#cb17-920" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Companies Affected'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'company'</span>].nunique()</span>
<span id="cb17-921"><a href="#cb17-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-922"><a href="#cb17-922" aria-hidden="true" tabindex="-1"></a><span class="co"># Most common violations by industry</span></span>
<span id="cb17-923"><a href="#cb17-923" aria-hidden="true" tabindex="-1"></a>market_impact[<span class="st">'Top Violation'</span>] <span class="op">=</span> df.groupby(<span class="st">'industry'</span>)[<span class="st">'article'</span>].agg(<span class="kw">lambda</span> x: x.mode().iloc[<span class="dv">0</span>])</span>
<span id="cb17-924"><a href="#cb17-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-925"><a href="#cb17-925" aria-hidden="true" tabindex="-1"></a><span class="co"># Display market impact statistics</span></span>
<span id="cb17-926"><a href="#cb17-926" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb17-927"><a href="#cb17-927" aria-hidden="true" tabindex="-1"></a>    market_impact.sort_values(<span class="st">'Average Fine'</span>, ascending<span class="op">=</span><span class="va">False</span>).values.tolist(),</span>
<span id="cb17-928"><a href="#cb17-928" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>market_impact.columns.tolist(),</span>
<span id="cb17-929"><a href="#cb17-929" aria-hidden="true" tabindex="-1"></a>    tablefmt<span class="op">=</span><span class="st">"pipe"</span>,</span>
<span id="cb17-930"><a href="#cb17-930" aria-hidden="true" tabindex="-1"></a>    numalign<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-931"><a href="#cb17-931" aria-hidden="true" tabindex="-1"></a>    stralign<span class="op">=</span><span class="st">"left"</span></span>
<span id="cb17-932"><a href="#cb17-932" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-933"><a href="#cb17-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-934"><a href="#cb17-934" aria-hidden="true" tabindex="-1"></a><span class="co"># Create impact visualization</span></span>
<span id="cb17-935"><a href="#cb17-935" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb17-936"><a href="#cb17-936" aria-hidden="true" tabindex="-1"></a>market_impact[[<span class="st">'Average Fine'</span>, <span class="st">'Fine Frequency'</span>]].plot(kind<span class="op">=</span><span class="st">'bar'</span>, secondary_y<span class="op">=</span><span class="st">'Fine Frequency'</span>)</span>
<span id="cb17-937"><a href="#cb17-937" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Market Impact by Industry'</span>)</span>
<span id="cb17-938"><a href="#cb17-938" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Industry'</span>)</span>
<span id="cb17-939"><a href="#cb17-939" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average Fine (€)'</span>)</span>
<span id="cb17-940"><a href="#cb17-940" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-941"><a href="#cb17-941" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-942"><a href="#cb17-942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>